{"ast":null,"code":"var _jsxFileName = \"/Users/janioviniciusmiara/Desktop/EstudosReact/vnda_ecommerce/src/providers/users.tsx\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { createContext, useContext, useReducer } from 'react';\nimport { url } from '../helpers/constants/urls';\nimport { useAxios } from '../helpers/axios';\nimport { useForm } from './formUser';\nimport { getDefaultUser } from '../types';\nconst UserContext = /*#__PURE__*/createContext(null);\nconst initialState = {\n  userList: [getDefaultUser()],\n  isValid: false,\n  error: false,\n  status: 'create'\n};\nvar ActionTypes;\n\n(function (ActionTypes) {\n  ActionTypes[\"GET_USER_LIST\"] = \"GET_USER_LIST\";\n  ActionTypes[\"STATUS\"] = \"STATUS\";\n  ActionTypes[\"ERROR\"] = \"ERROR\";\n})(ActionTypes || (ActionTypes = {}));\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case ActionTypes.GET_USER_LIST:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        userList: action.userList,\n        error: false\n      });\n\n    case ActionTypes.STATUS:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        status: action.value\n      });\n\n    case ActionTypes.ERROR:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        error: true\n      });\n\n    default:\n      return state;\n  }\n}\n\nexport function useUser() {\n  const {\n    apiClient,\n    errorHandler\n  } = useAxios();\n  const {\n    clearForm,\n    validateUser,\n    user,\n    status\n  } = useForm();\n  const {\n    0: {\n      userList,\n      isValid,\n      error\n    },\n    1: dispatch\n  } = useContext(UserContext);\n\n  const getUsers = async () => {\n    try {\n      const {\n        data\n      } = await apiClient.get(url.USER_LIST);\n      dispatch({\n        type: ActionTypes.GET_USER_LIST,\n        userList: data\n      });\n    } catch (err) {\n      dispatch({\n        type: ActionTypes.ERROR\n      });\n    }\n  };\n\n  const submitForm = () => {\n    if (status === 'create') {\n      return createUsers();\n    } else {\n      return udpateUser();\n    }\n  };\n\n  const createUsers = async () => {\n    if (validateUser) {\n      try {\n        await apiClient.post(url.USER_LIST, user);\n        await getUsers();\n        await clearForm();\n        return true;\n      } catch (err) {\n        dispatch({\n          type: ActionTypes.ERROR\n        });\n        return false;\n      }\n    }\n  };\n\n  const udpateUser = async () => {\n    const {\n      id\n    } = user;\n\n    try {\n      if (isValid) {\n        await apiClient.patch(`${url.USER_LIST}/${id}`, user);\n        await getUsers();\n        await clearForm();\n        return true;\n      }\n    } catch (err) {\n      errorHandler(err);\n      return false;\n    }\n  };\n\n  return {\n    userList,\n    user,\n    isValid,\n    error,\n    getUsers,\n    validateUser,\n    createUsers,\n    submitForm\n  };\n}\n\nconst UserProvider = ({\n  children\n}) => {\n  const {\n    0: state,\n    1: dispatch\n  } = useReducer(reducer, initialState);\n  return __jsx(UserContext.Provider, {\n    value: [state, dispatch],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 5\n    }\n  }, children);\n};\n\nexport { UserContext, UserProvider };","map":{"version":3,"sources":["/Users/janioviniciusmiara/Desktop/EstudosReact/vnda_ecommerce/src/providers/users.tsx"],"names":["React","createContext","useContext","useReducer","url","useAxios","useForm","getDefaultUser","UserContext","initialState","userList","isValid","error","status","ActionTypes","reducer","state","action","type","GET_USER_LIST","STATUS","value","ERROR","useUser","apiClient","errorHandler","clearForm","validateUser","user","dispatch","getUsers","data","get","USER_LIST","err","submitForm","createUsers","udpateUser","post","id","patch","UserProvider","children"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IACEC,aADF,EAIEC,UAJF,EAKEC,UALF,QAMO,OANP;AAQA,SAASC,GAAT,QAAoB,2BAApB;AACA,SAASC,QAAT,QAAyB,kBAAzB;AACA,SAASC,OAAT,QAAwB,YAAxB;AACA,SAASC,cAAT,QAAsC,UAAtC;AAEA,MAAMC,WAAW,gBAAGP,aAAa,CAAC,IAAD,CAAjC;AAEA,MAAMQ,YAKL,GAAG;AACFC,EAAAA,QAAQ,EAAE,CAACH,cAAc,EAAf,CADR;AAEFI,EAAAA,OAAO,EAAE,KAFP;AAGFC,EAAAA,KAAK,EAAE,KAHL;AAIFC,EAAAA,MAAM,EAAE;AAJN,CALJ;IAYKC,W;;WAAAA,W;AAAAA,EAAAA,W;AAAAA,EAAAA,W;AAAAA,EAAAA,W;GAAAA,W,KAAAA,W;;AAeL,SAASC,OAAT,CAAiBC,KAAjB,EAA6CC,MAA7C,EAA6D;AAC3D,UAAQA,MAAM,CAACC,IAAf;AACE,SAAKJ,WAAW,CAACK,aAAjB;AACE,6CAAYH,KAAZ;AAAmBN,QAAAA,QAAQ,EAAEO,MAAM,CAACP,QAApC;AAA8CE,QAAAA,KAAK,EAAE;AAArD;;AACF,SAAKE,WAAW,CAACM,MAAjB;AACE,6CAAYJ,KAAZ;AAAmBH,QAAAA,MAAM,EAAEI,MAAM,CAACI;AAAlC;;AACF,SAAKP,WAAW,CAACQ,KAAjB;AACE,6CAAYN,KAAZ;AAAmBJ,QAAAA,KAAK,EAAE;AAA1B;;AACF;AACE,aAAOI,KAAP;AARJ;AAUD;;AAED,OAAO,SAASO,OAAT,GAAmB;AACxB,QAAM;AAAEC,IAAAA,SAAF;AAAaC,IAAAA;AAAb,MAA8BpB,QAAQ,EAA5C;AACA,QAAM;AAAEqB,IAAAA,SAAF;AAAaC,IAAAA,YAAb;AAA2BC,IAAAA,IAA3B;AAAiCf,IAAAA;AAAjC,MAA4CP,OAAO,EAAzD;AAEA,QAAM;AAAA,OAAC;AAAEI,MAAAA,QAAF;AAAYC,MAAAA,OAAZ;AAAqBC,MAAAA;AAArB,KAAD;AAAA,OAA+BiB;AAA/B,MAA2C3B,UAAU,CAEzDM,WAFyD,CAA3D;;AAIA,QAAMsB,QAAQ,GAAG,YAA2B;AAC1C,QAAI;AACF,YAAM;AAAEC,QAAAA;AAAF,UAAW,MAAMP,SAAS,CAACQ,GAAV,CAAuB5B,GAAG,CAAC6B,SAA3B,CAAvB;AACAJ,MAAAA,QAAQ,CAAC;AAAEX,QAAAA,IAAI,EAAEJ,WAAW,CAACK,aAApB;AAAmCT,QAAAA,QAAQ,EAAEqB;AAA7C,OAAD,CAAR;AACD,KAHD,CAGE,OAAOG,GAAP,EAAY;AACZL,MAAAA,QAAQ,CAAC;AAAEX,QAAAA,IAAI,EAAEJ,WAAW,CAACQ;AAApB,OAAD,CAAR;AACD;AACF,GAPD;;AASA,QAAMa,UAAU,GAAG,MAAM;AACvB,QAAItB,MAAM,KAAK,QAAf,EAAyB;AACvB,aAAOuB,WAAW,EAAlB;AACD,KAFD,MAEO;AACL,aAAOC,UAAU,EAAjB;AACD;AACF,GAND;;AAQA,QAAMD,WAAW,GAAG,YAAY;AAC9B,QAAIT,YAAJ,EAAkB;AAChB,UAAI;AACF,cAAMH,SAAS,CAACc,IAAV,CAAsBlC,GAAG,CAAC6B,SAA1B,EAAqCL,IAArC,CAAN;AACA,cAAME,QAAQ,EAAd;AACA,cAAMJ,SAAS,EAAf;AACA,eAAO,IAAP;AACD,OALD,CAKE,OAAOQ,GAAP,EAAY;AACZL,QAAAA,QAAQ,CAAC;AAAEX,UAAAA,IAAI,EAAEJ,WAAW,CAACQ;AAApB,SAAD,CAAR;AACA,eAAO,KAAP;AACD;AACF;AACF,GAZD;;AAcA,QAAMe,UAAU,GAAG,YAAY;AAC7B,UAAM;AAAEE,MAAAA;AAAF,QAASX,IAAf;;AACA,QAAI;AACF,UAAIjB,OAAJ,EAAa;AACX,cAAMa,SAAS,CAACgB,KAAV,CAAiB,GAAEpC,GAAG,CAAC6B,SAAU,IAAGM,EAAG,EAAvC,EAA0CX,IAA1C,CAAN;AACA,cAAME,QAAQ,EAAd;AACA,cAAMJ,SAAS,EAAf;AACA,eAAO,IAAP;AACD;AACF,KAPD,CAOE,OAAOQ,GAAP,EAAY;AACZT,MAAAA,YAAY,CAACS,GAAD,CAAZ;AACA,aAAO,KAAP;AACD;AACF,GAbD;;AAeA,SAAO;AACLxB,IAAAA,QADK;AAELkB,IAAAA,IAFK;AAGLjB,IAAAA,OAHK;AAILC,IAAAA,KAJK;AAKLkB,IAAAA,QALK;AAMLH,IAAAA,YANK;AAOLS,IAAAA,WAPK;AAQLD,IAAAA;AARK,GAAP;AAUD;;AAED,MAAMM,YAA+B,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAkB;AACxD,QAAM;AAAA,OAAC1B,KAAD;AAAA,OAAQa;AAAR,MAAoB1B,UAAU,CAACY,OAAD,EAAUN,YAAV,CAApC;AAEA,SACE,MAAC,WAAD,CAAa,QAAb;AAAsB,IAAA,KAAK,EAAE,CAACO,KAAD,EAAQa,QAAR,CAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGa,QADH,CADF;AAKD,CARD;;AAUA,SAASlC,WAAT,EAAsBiC,YAAtB","sourcesContent":["import React, {\n  createContext,\n  Dispatch,\n  FunctionComponent,\n  useContext,\n  useReducer\n} from 'react'\n\nimport { url } from '../helpers/constants/urls'\nimport { useAxios } from '../helpers/axios'\nimport { useForm } from './formUser'\nimport { getDefaultUser, IUser } from '../types'\n\nconst UserContext = createContext(null)\n\nconst initialState: {\n  userList: IUser[]\n  isValid: boolean\n  status: string\n  error?: boolean\n} = {\n  userList: [getDefaultUser()],\n  isValid: false,\n  error: false,\n  status: 'create'\n}\n\nenum ActionTypes {\n  GET_USER_LIST = 'GET_USER_LIST',\n  STATUS = 'STATUS',\n  ERROR = 'ERROR'\n}\n\ninterface Action {\n  name?: string\n  value?: any\n  user?: IUser\n  isValid?: boolean\n  userList?: IUser[]\n  type: ActionTypes\n}\n\nfunction reducer(state: typeof initialState, action: Action) {\n  switch (action.type) {\n    case ActionTypes.GET_USER_LIST:\n      return { ...state, userList: action.userList, error: false }\n    case ActionTypes.STATUS:\n      return { ...state, status: action.value }\n    case ActionTypes.ERROR:\n      return { ...state, error: true }\n    default:\n      return state\n  }\n}\n\nexport function useUser() {\n  const { apiClient, errorHandler } = useAxios()\n  const { clearForm, validateUser, user, status } = useForm()\n\n  const [{ userList, isValid, error }, dispatch] = useContext<\n    [typeof initialState, Dispatch<Action>]\n  >(UserContext)\n\n  const getUsers = async (): Promise<void> => {\n    try {\n      const { data } = await apiClient.get<IUser[]>(url.USER_LIST)\n      dispatch({ type: ActionTypes.GET_USER_LIST, userList: data })\n    } catch (err) {\n      dispatch({ type: ActionTypes.ERROR })\n    }\n  }\n\n  const submitForm = () => {\n    if (status === 'create') {\n      return createUsers()\n    } else {\n      return udpateUser()\n    }\n  }\n\n  const createUsers = async () => {\n    if (validateUser) {\n      try {\n        await apiClient.post<IUser>(url.USER_LIST, user)\n        await getUsers()\n        await clearForm()\n        return true\n      } catch (err) {\n        dispatch({ type: ActionTypes.ERROR })\n        return false\n      }\n    }\n  }\n\n  const udpateUser = async () => {\n    const { id } = user\n    try {\n      if (isValid) {\n        await apiClient.patch(`${url.USER_LIST}/${id}`, user)\n        await getUsers()\n        await clearForm()\n        return true\n      }\n    } catch (err) {\n      errorHandler(err)\n      return false\n    }\n  }\n\n  return {\n    userList,\n    user,\n    isValid,\n    error,\n    getUsers,\n    validateUser,\n    createUsers,\n    submitForm\n  }\n}\n\nconst UserProvider: FunctionComponent = ({ children }) => {\n  const [state, dispatch] = useReducer(reducer, initialState)\n\n  return (\n    <UserContext.Provider value={[state, dispatch]}>\n      {children}\n    </UserContext.Provider>\n  )\n}\n\nexport { UserContext, UserProvider }\n"]},"metadata":{},"sourceType":"module"}